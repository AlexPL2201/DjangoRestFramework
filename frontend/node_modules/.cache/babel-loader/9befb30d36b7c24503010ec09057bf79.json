{"ast":null,"code":"var _jsxFileName = \"/Users/sasha/Desktop/DjangoRestFramework/frontend/src/App.js\";\nimport './App.css';\nimport React from 'react';\nimport axios from \"axios\";\nimport { BrowserRouter as Router, Route, Routes, Link } from 'react-router-dom';\nimport UserList from \"./components/User\";\nimport ToDoList from \"./components/ToDo\";\nimport ProjectList from \"./components/Projects\";\nimport Navbar from \"./components/Menu\";\nimport LoginForm from \"./components/Auth\";\nimport Cookies from 'universal-cookie';\nimport './components/bootstrap/css/bootstrap.min.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      'navbar': [{\n        name: 'Список пользователей',\n        href: '/users'\n      }, {\n        name: 'Список проектов',\n        href: '/projects'\n      }, {\n        name: 'Список ToDo',\n        href: '/notes'\n      }],\n      'notes': [],\n      'users': [],\n      'projects': [],\n      'auth': {\n        'username': '',\n        'token': ''\n      }\n    };\n  }\n\n  set_token(username, token) {\n    const cookies = new Cookies();\n    cookies.set('token', token);\n    cookies.set('username', username);\n    this.setState({\n      'auth': {\n        'username': username,\n        'token': token\n      }\n    }, () => this.load_data());\n  }\n\n  is_authenticated() {\n    return this.state.auth.token !== '';\n  }\n\n  logout() {\n    this.set_token('', '');\n  }\n\n  get_token_from_storage() {\n    const cookies = new Cookies();\n    const token = cookies.get('token');\n    const username = cookies.get('username');\n    this.setState({\n      auth: {\n        'username': username,\n        'token': token\n      }\n    }, () => this.load_data());\n  }\n\n  get_token(username, password) {\n    axios.post('http://127.0.0.1:8000/api-auth-token/', {\n      username: username,\n      password: password\n    }).then(response => {\n      this.set_token(username, response.data['token']);\n    }).catch(error => alert('Неверный логин или пароль'));\n  }\n\n  load_data() {\n    const headers = this.get_headers();\n    axios.get('http://127.0.0.1:8000/api/notes/', {\n      headers\n    }).then(response => {\n      this.setState({\n        'notes': response.data.results\n      });\n    }).catch(error => console.log(error));\n    axios.get('http://127.0.0.1:8000/api/projects/', {\n      headers\n    }).then(response => {\n      this.setState({\n        'projects': response.data.results\n      });\n    }).catch(error => {\n      console.log(error);\n      this.setState({\n        projects: []\n      });\n    });\n    axios.get('http://127.0.0.1:8000/api/users/', {\n      headers\n    }).then(response => {\n      this.setState({\n        'users': response.data\n      });\n    }).catch(error => console.log(error));\n  }\n\n  get_headers() {\n    let headers = {\n      'Content-Type': 'application/json'\n    };\n\n    if (this.is_authenticated()) {\n      headers['Authorization'] = 'Token ' + this.state.auth.token;\n    }\n\n    return headers;\n  }\n\n  componentDidMount() {\n    this.get_token_from_storage();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(Router, {\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        children: /*#__PURE__*/_jsxDEV(Navbar, {\n          navbarItems: this.state.navbar,\n          username: this.state.auth.username,\n          token: this.state.auth.token,\n          logout: () => this.logout()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        role: \"main\",\n        className: \"flex-shrink-0\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(Routes, {\n            children: [/*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/users\",\n              element: /*#__PURE__*/_jsxDEV(UserList, {\n                items: this.state.users\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 113,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/notes\",\n              element: /*#__PURE__*/_jsxDEV(ToDoList, {\n                items: this.state.notes\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/projects\",\n              element: /*#__PURE__*/_jsxDEV(ProjectList, {\n                items: this.state.projects\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 56\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(Route, {\n              exact: true,\n              path: \"/login\",\n              element: /*#__PURE__*/_jsxDEV(LoginForm, {\n                get_token: (username, password) => this.get_token(username, password)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"names":["React","axios","BrowserRouter","Router","Route","Routes","Link","UserList","ToDoList","ProjectList","Navbar","LoginForm","Cookies","App","Component","constructor","props","state","name","href","set_token","username","token","cookies","set","setState","load_data","is_authenticated","auth","logout","get_token_from_storage","get","get_token","password","post","then","response","data","catch","error","alert","headers","get_headers","results","console","log","projects","componentDidMount","render","navbar","users","notes"],"sources":["/Users/sasha/Desktop/DjangoRestFramework/frontend/src/App.js"],"sourcesContent":["import './App.css';\nimport React from 'react';\nimport axios from \"axios\";\nimport {\n    BrowserRouter as Router,\n    Route,\n    Routes,\n    Link,\n} from 'react-router-dom'\n\nimport UserList from \"./components/User\";\nimport ToDoList from \"./components/ToDo\";\nimport ProjectList from \"./components/Projects\"\nimport Navbar from \"./components/Menu\";\nimport LoginForm from \"./components/Auth\";\nimport Cookies from 'universal-cookie';\nimport './components/bootstrap/css/bootstrap.min.css';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      'navbar' : [\n        {name : 'Список пользователей', href: '/users'},\n        {name: 'Список проектов', href: '/projects'},\n        {name: 'Список ToDo', href: '/notes'},\n      ],\n      'notes': [],\n      'users': [],\n      'projects': [],\n      'auth': {'username': '', 'token': ''}\n    };\n  }\n\n  set_token(username, token) {\n    const cookies = new Cookies()\n    cookies.set('token', token)\n    cookies.set('username', username)\n    this.setState({'auth':{'username': username, 'token': token}}, ()=>this.load_data())\n  }\n\n  is_authenticated() {\n    return this.state.auth.token !== ''\n  }\n\n  logout() {\n    this.set_token('', '')\n  }\n\n  get_token_from_storage() {\n    const cookies = new Cookies()\n    const token = cookies.get('token')\n    const username = cookies.get('username')\n    this.setState({auth:{'username': username, 'token': token}}, ()=>this.load_data())\n  }\n\n  get_token(username, password) {\n    axios.post('http://127.0.0.1:8000/api-auth-token/', {username: username, password: password})\n        .then(response => {\n            this.set_token(username, response.data['token'])\n        }).catch(error => alert('Неверный логин или пароль'))\n  }\n\n  load_data() {\n    const headers = this.get_headers()\n\n    axios.get('http://127.0.0.1:8000/api/notes/', {headers})\n      .then(response =>{\n      this.setState({\n        'notes':response.data.results\n      })\n    }).catch(error => console.log(error));\n\n    axios.get('http://127.0.0.1:8000/api/projects/', {headers})\n      .then(response =>{\n      this.setState({\n        'projects':response.data.results\n      })\n    }).catch(error => {\n      console.log(error);\n      this.setState({projects: []})\n    })\n\n    axios.get('http://127.0.0.1:8000/api/users/', {headers})\n      .then(response =>{\n      this.setState({\n        'users':response.data\n      })\n    }).catch(error => console.log(error));\n  }\n\n  get_headers() {\n    let headers = { 'Content-Type': 'application/json' }\n    if (this.is_authenticated()) {\n        headers['Authorization'] = 'Token ' + this.state.auth.token\n    }\n    return headers\n  }\n\n  componentDidMount() {\n    this.get_token_from_storage()\n  }\n\n  render() {\n    return (\n      <Router>\n        <header>\n          <Navbar navbarItems={this.state.navbar} username={this.state.auth.username} token={this.state.auth.token} logout={() => this.logout()}/>\n        </header>\n        <main role=\"main\" className=\"flex-shrink-0\">\n        <div className=\"container\">\n          <Routes>\n            <Route exact path = '/users' element = {<UserList items={this.state.users} /> } />\n\n            <Route exact path = '/notes' element = {<ToDoList items={this.state.notes} /> } />\n\n            <Route exact path = '/projects' element = {<ProjectList items={this.state.projects} /> } />\n\n            <Route exact path = '/login' element = {<LoginForm get_token={(username, password) => this.get_token(username, password)} />} />\n          </Routes>\n        </div>\n        </main>\n      </Router>\n    )\n  }\n}\n\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}